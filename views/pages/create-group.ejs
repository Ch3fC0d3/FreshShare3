<%- contentFor('style') %>
<style>
    .create-group-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }
    
    .form-section {
        margin-bottom: 30px;
        padding: 20px;
        background-color: #fff;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .form-section h3 {
        margin-bottom: 20px;
        color: #2c3e50;
        border-bottom: 1px solid #eee;
        padding-bottom: 10px;
    }
    
    .form-group {
        margin-bottom: 20px;
    }
    
    .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: 500;
        color: #333;
    }
    
    .form-group input,
    .form-group textarea,
    .form-group select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 16px;
    }
    
    .form-group textarea {
        min-height: 100px;
    }
    
    .form-group select {
        height: 42px;
    }
    
    .delivery-days {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }
    
    .day-checkbox {
        display: flex;
        align-items: center;
        margin-right: 15px;
    }
    
    .day-checkbox input {
        margin-right: 5px;
        width: auto;
    }
    
    .required-field::after {
        content: "*";
        color: #e74c3c;
        margin-left: 4px;
    }
    
    .form-actions {
        display: flex;
        justify-content: space-between;
        margin-top: 30px;
    }
    
    .preview-image {
        max-width: 100%;
        height: 200px;
        object-fit: cover;
        border-radius: 8px;
        margin-top: 10px;
        display: none;
    }
    
    .error-message {
        color: #e74c3c;
        font-size: 14px;
        margin-top: 5px;
        display: none;
    }

    .starter-products-container {
        border: 1px solid #e1e5ea;
        border-radius: 8px;
        padding: 16px;
        background-color: #fafcff;
    }

    .starter-product-card {
        border: 1px solid #d9dee8;
        border-radius: 6px;
        padding: 12px;
        margin-bottom: 12px;
        background-color: #fff;
        position: relative;
    }

    .starter-product-card .remove-product-btn {
        position: absolute;
        top: 10px;
        right: 10px;
    }

    .form-hint {
        font-size: 14px;
        color: #6c7a89;
        margin-bottom: 10px;
    }
</style>

<%- contentFor('body') %>
<div class="main-content">
    <div class="create-group-container">
        <h1 class="page-title">Create a New Group</h1>
        <p class="page-description">
            Create a group to connect with people who share your interests in food, gardening, or community building.
        </p>
        
        <!-- Auth Debug Info -->
        <div id="auth-debug" style="background-color: #f8f9fa; padding: 10px; margin-bottom: 20px; border-radius: 5px;">
            <h5>Authentication Debug</h5>
            <div id="cookie-status"></div>
            <div id="localstorage-status"></div>
            <div id="token-value"></div>
            <button id="debug-toggle" class="btn btn-sm btn-secondary mt-2">Show Token</button>
        </div>
        
        <form id="create-group-form">
            <!-- Basic Information -->
            <div class="form-section">
                <h3>Basic Information</h3>
                
                <div class="form-group">
                    <label for="group-name" class="required-field">Group Name</label>
                    <input type="text" id="group-name" name="name" required placeholder="Enter a unique name for your group">
                    <div class="error-message" id="name-error"></div>
                </div>
                
                <div class="form-group">
                    <label for="group-category" class="required-field">Category</label>
                    <select id="group-category" name="category" required>
                        <option value="" disabled selected>Select a category</option>
                        <option value="neighborhood">Neighborhood Group</option>
                        <option value="community_garden">Community Garden</option>
                        <option value="food_bank">Food Bank / Pantry</option>
                        <option value="cooking_club">Cooking Club</option>
                        <option value="other">Other</option>
                    </select>
                    <div class="error-message" id="category-error"></div>
                </div>
                
                <div class="form-group">
                    <label for="group-description" class="required-field">Description</label>
                    <textarea id="group-description" name="description" required placeholder="Describe your group's purpose, goals, and activities"></textarea>
                    <div class="error-message" id="description-error"></div>
                </div>
            </div>
            
            <!-- Location Information -->
            <div class="form-section">
                <h3>Location</h3>
                
                <div class="form-group">
                    <label for="group-street">Street Address</label>
                    <input type="text" id="group-street" name="location.street" placeholder="Street address (optional)">
                </div>
                
                <div class="form-group">
                    <label for="group-city" class="required-field">City</label>
                    <input type="text" id="group-city" name="location.city" required placeholder="City">
                    <div class="error-message" id="city-error"></div>
                </div>
                
                <div class="form-group">
                    <label for="group-state">State/Province</label>
                    <input type="text" id="group-state" name="location.state" placeholder="State or province">
                </div>
                
                <div class="form-group">
                    <label for="group-zipcode" class="required-field">Zip/Postal Code</label>
                    <input type="text" id="group-zipcode" name="location.zipCode" required placeholder="Zip or postal code">
                    <div class="error-message" id="zipcode-error"></div>
                </div>
            </div>
            
            <!-- Group Settings -->
            <div class="form-section">
                <h3>Group Settings</h3>
                
                <div class="form-group">
                    <label for="group-rules">Group Rules</label>
                    <textarea id="group-rules" name="rules" placeholder="Set some ground rules for your group (optional)"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="required-field">Delivery Days</label>
                    <p class="form-hint">Select days when your group typically receives deliveries or meets</p>
                    <div class="delivery-days">
                        <div class="day-checkbox">
                            <input type="checkbox" id="monday" name="deliveryDays" value="Monday">
                            <label for="monday">Monday</label>
                        </div>
                        <div class="day-checkbox">
                            <input type="checkbox" id="tuesday" name="deliveryDays" value="Tuesday">
                            <label for="tuesday">Tuesday</label>
                        </div>
                        <div class="day-checkbox">
                            <input type="checkbox" id="wednesday" name="deliveryDays" value="Wednesday">
                            <label for="wednesday">Wednesday</label>
                        </div>
                        <div class="day-checkbox">
                            <input type="checkbox" id="thursday" name="deliveryDays" value="Thursday">
                            <label for="thursday">Thursday</label>
                        </div>
                        <div class="day-checkbox">
                            <input type="checkbox" id="friday" name="deliveryDays" value="Friday">
                            <label for="friday">Friday</label>
                        </div>
                        <div class="day-checkbox">
                            <input type="checkbox" id="saturday" name="deliveryDays" value="Saturday">
                            <label for="saturday">Saturday</label>
                        </div>
                        <div class="day-checkbox">
                            <input type="checkbox" id="sunday" name="deliveryDays" value="Sunday">
                            <label for="sunday">Sunday</label>
                        </div>
                    </div>
                    <div class="error-message" id="delivery-days-error"></div>
                </div>
                
                <div class="form-group">
                    <label>Group Shopping Schedule</label>
                    <p class="form-hint">Optionally set weekly order and pickup windows for this group.</p>
                    <div class="row g-3 align-items-end">
                        <div class="col-md-3">
                            <label for="order-by-day" class="form-label">Order by day</label>
                            <select class="form-select" id="order-by-day" name="orderByDay">
                                <option value="">Select day</option>
                                <option value="Sunday">Sunday</option>
                                <option value="Monday">Monday</option>
                                <option value="Tuesday">Tuesday</option>
                                <option value="Wednesday">Wednesday</option>
                                <option value="Thursday">Thursday</option>
                                <option value="Friday">Friday</option>
                                <option value="Saturday">Saturday</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="order-by-time" class="form-label">Order by time</label>
                            <input type="time" class="form-control" id="order-by-time" name="orderByTime" />
                        </div>
                        <div class="col-md-3">
                            <label for="delivery-day" class="form-label">Delivery day</label>
                            <select class="form-select" id="delivery-day" name="deliveryDay">
                                <option value="">Select day</option>
                                <option value="Sunday">Sunday</option>
                                <option value="Monday">Monday</option>
                                <option value="Tuesday">Tuesday</option>
                                <option value="Wednesday">Wednesday</option>
                                <option value="Thursday">Thursday</option>
                                <option value="Friday">Friday</option>
                                <option value="Saturday">Saturday</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="delivery-time" class="form-label">Delivery time</label>
                            <input type="time" class="form-control" id="delivery-time" name="deliveryTime" />
                        </div>
                    </div>
                    <div class="error-message" id="schedule-error"></div>
                </div>

                <div class="form-group">
                    <label for="max-active-products" class="required-field">Max Active Products</label>
                    <p class="form-hint">Set how many products can be active at once in your group marketplace. Top-ranked items up to this number become buyable.</p>
                    <input type="number" id="max-active-products" name="maxActiveProducts" min="1" max="200" value="20" />
                    <div class="error-message" id="max-active-products-error"></div>
                </div>

                <div class="form-group">
                    <label>Starter Products (Optional)</label>
                    <p class="form-hint">Pre-load items for the ranked list. These start as active if they fall within your max active products cap.</p>
                    <div class="starter-products-container" id="starter-products-container">
                        <div id="starter-products-list"></div>
                        <button type="button" class="btn btn-outline-primary" id="add-starter-product-btn">
                            <i class="fas fa-plus"></i> Add Starter Product
                        </button>
                    </div>
                    <div class="error-message" id="starter-products-error"></div>
                </div>
                
                <div class="form-group">
                    <label for="group-privacy">Privacy Setting</label>
                    <select id="group-privacy" name="isPrivate">
                        <option value="false">Public - Anyone can find and join</option>
                        <option value="true">Private - By invitation only</option>
                    </select>
                </div>
            </div>
            
            <div class="form-actions">
                <button type="button" class="btn btn-outline" id="cancel-btn">Cancel</button>
                <button type="submit" class="btn btn-primary" id="create-btn">Create Group</button>
            </div>
        </form>
    </div>
</div>

<%- contentFor('script') %>
<script src="/js/create-group-page.js"></script>
