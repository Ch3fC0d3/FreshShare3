<!DOCTYPE html>
<html>
<head>
  <title>FreshShare Connection Test</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    .result { margin: 10px 0; padding: 10px; border: 1px solid #ddd; }
    .success { background-color: #d4edda; }
    .error { background-color: #f8d7da; }
    button { padding: 8px 16px; margin: 5px; }
  </style>
</head>
<body>
  <h1>FreshShare Connection Test</h1>
  
  <div class="control-panel">
    <h2>API Connection Tests</h2>
    <p>Use these buttons to test connectivity to different ports</p>
    
    <div>
      <button onclick="testConnection(3000)">Test Port 3000</button>
      <button onclick="testConnection(3001)">Test Port 3001</button>
      <button onclick="testConnection(3002)">Test Port 3002</button>
      <button onclick="testConnection(3003)">Test Port 3003</button>
    </div>
    
    <h2>Results:</h2>
    <div id="results"></div>
  </div>

  <script>
    // Function to test connection to a specific port
    async function testConnection(port) {
      const resultsDiv = document.getElementById('results');
      const resultDiv = document.createElement('div');
      resultDiv.className = 'result';
      
      try {
        resultsDiv.prepend(resultDiv);
        resultDiv.innerHTML = `Testing connection to http://localhost:${port}...`;
        
        const response = await fetch(`http://localhost:${port}/api/test`, {
          method: 'GET',
          headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
          },
          // Short timeout to avoid hanging
          signal: AbortSignal.timeout(2000)
        });
        
        if (response.ok) {
          const data = await response.json();
          resultDiv.className = 'result success';
          resultDiv.innerHTML = `
            <strong>✅ Connection to port ${port} succeeded!</strong><br>
            Status: ${response.status}<br>
            Response: ${JSON.stringify(data)}
          `;
        } else {
          resultDiv.className = 'result error';
          resultDiv.innerHTML = `
            <strong>❌ Connection to port ${port} failed!</strong><br>
            Status: ${response.status} ${response.statusText}<br>
          `;
        }
      } catch (err) {
        resultDiv.className = 'result error';
        resultDiv.innerHTML = `
          <strong>❌ Connection to port ${port} failed!</strong><br>
          Error: ${err.message}<br>
        `;
      }
    }
  </script>
</body>
</html>
